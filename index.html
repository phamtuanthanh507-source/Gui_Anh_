<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>G·ª≠i Anh Y√™u ‚ù§Ô∏è</title>
<style>
  :root{
    --bg: #f38dbe;
    --accent: #f77ca3;
    --paper: #faf8f9;
    --text: #2b2b2b;
    --shadow: rgba(12,12,12,0.12);
  }
  html,body{
    height:100%;
    margin:0;
    font-family:"Inter",system-ui;
    background:linear-gradient(180deg,var(--bg),#fff);
    overflow:hidden;
  }

  .stage{
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
    box-sizing:border-box;
    position: relative;
  }

  .card {
    width: min(420px, 86vw);
    aspect-ratio: 9 / 16;
    display:flex;
    align-items:center;
    justify-content:center;
    position: relative;
    z-index: 5;
    transform: scale(1);
    transform-origin: center;
  }

  .click-area{
    width:100%;
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    user-select:none;
    position: relative;
  }

  /* üå∏ ·∫¢nh n·ªÅn l√° th∆∞ */
  .envelope-bg {
    width: 78%;
    max-width: 360px;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 0;
    pointer-events: none;
  }

  /* ‚úâÔ∏è Phong b√¨ */
  .envelope-wrap {
    width:78%;
    max-width:360px;
    position:relative;
    transition: transform .45s cubic-bezier(.2,.9,.3,1);
    transform-origin:50% 60%;
    z-index:3;
    filter: drop-shadow(0 10px 18px var(--shadow));
    perspective: 800px;
  }
  .envelope-wrap.idle { animation: float 6s ease-in-out infinite; }
  @keyframes float {
    0%{ transform: translateY(0) }
    50%{ transform: translateY(-6px) }
    100%{ transform: translateY(0) }
  }

  .envelope-body {
    width: 100%;
    display: block;
    position: relative;
    z-index: 3;
  }

  .envelope-lid {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    transform-origin: top center;
    transition: transform 0.6s ease;
    cursor: pointer;
    z-index: 1;
    backface-visibility: hidden;
  }
  .envelope-lid.open {
    transform: rotateX(-100deg);
    z-index: 2;
  }

  /* üíå Note */
  .note {
    position: absolute;
    width: %;
    left: 50%;
    top: 20%;
    transform: translate(-50%, 80%) scale(0.8);
    background: linear-gradient(180deg, #fff 0%, var(--paper) 100%);
    border-radius: 10px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.12);
    padding: px;
    text-align: center;
    opacity: 0;
    z-index: 4;
  }

  .note.animate {
    animation: popNote 1.4s ease-out forwards;
  }

  @keyframes popNote {
    0% { opacity: 0; transform: translate(-70%, 80%) scale(0.8); }
    20% { opacity: 1; transform: translate(-60%, 50%) scale(1.05); }
    60% { transform: translate(-50%, 500%) scale(1); }
    75% { transform: translate(-50%, 500%) scale(0.98); }
    100% { opacity: 1; transform: translate(-50%, 500%) scale(1); }
  }

  /* üìÑ Th∆∞ */
  .letter {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%) scale(0.);
    width: min(380px, 86vw);
    background: linear-gradient(180deg,#fff,#fff9fb);
    border-radius:14px;
    box-shadow:0 18px 40px rgba(0,0,0,0.14);
    padding:20px;
    opacity:0;
    pointer-events:none;
    transform-origin:center;
    transition: all .45s cubic-bezier(.2,.9,.3,1);
    z-index:7;
    max-height:75%;
    overflow:auto;
  }
  .letter.open{ opacity:1; pointer-events:auto; transform:translate(-50%,-50%) scale(1); }

  .lines{ display:flex; flex-direction:column; gap:10px; margin-top:6px; }
  .line{ height:10px; background:linear-gradient(90deg,rgba(0,0,0,0.08),rgba(0,0,0,0.04)); border-radius:6px; opacity:0; transform:translateY(6px); transition:all .38s cubic-bezier(.25,.9,.3,1);}
  .line.show{ opacity:1; transform:translateY(0); }

  .letter h3{ margin:0 0 8px; font-size:18px; color:var(--accent); text-align:center;}
  .letter p{ margin:0; color:var(--text); font-size:15px; line-height:1.45; }

  /* üìù H∆∞·ªõng d·∫´n */
  .guide {
    position: absolute;
    bottom: 30%;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    animation: fadeIn 1s ease forwards;
    z-index: 10;
  }

  .arrow {
    width: 0;
    height: 0;
    border-left: 14px solid transparent;
    border-right: 14px solid transparent;
    border-bottom: 24px solid var(--accent);
    animation: bounce 1s infinite alternate;
  }

  .guide-text {
    margin-top: 8px;
    background: rgba(255,255,255,0.85);
    padding: 8px 14px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    font-size: 14px;
    color: var(--text);
    white-space: nowrap;
  }

  @keyframes bounce {
    0% { transform: translateY(0); }
    100% { transform: translateY(-10px); }
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translate(-50%, -20%); }
    to { opacity: 1; transform: translate(-50%, 0); }
  }

  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  /* ‚ú® Bling */
  .bling-container {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
    z-index: 1;
  }

  .bling {
    position: absolute;
    width: 10px;
    height: 10px;
    background: radial-gradient(white, rgba(255,255,255,0));
    box-shadow: 0 0 8px white, 0 0 14px rgba(255,255,255,0.8);
    border-radius: 50%;
    opacity: 0;
    animation: bling 3s infinite ease-in-out;
  }

  @keyframes bling {
    0% { opacity: 0; transform: scale(0.4) translateY(0); }
    50% { opacity: 1; transform: scale(1.4) translateY(-10px); }
    100% { opacity: 0; transform: scale(0.4) translateY(0); }
  }

  /* üíñ Floating Hearts */
  .heart {
    position: fixed;
    bottom: -40px;
    font-size: 22px;
    color: #ff4d88;
    opacity: 0.8;
    animation: floatHeart 6s linear infinite;
    pointer-events: none;
    z-index: 2;
  }

  @keyframes floatHeart {
    0% { transform: translateY(0) translateX(0) scale(0.8) rotate(0deg); opacity: 0; }
    10% { opacity: 0.9; }
    50% { transform: translateY(-50vh) translateX(20px) scale(1) rotate(20deg); opacity: 1; }
    100% { transform: translateY(-100vh) translateX(-20px) scale(1.2) rotate(-20deg); opacity: 0; }
  }
</style>
</head>
<body>

<!-- ‚ú® Bling -->
<div class="bling-container" id="blingContainer"></div>

<div class="stage">
  <div class="card">
    <div class="click-area" id="clickArea">

      <!-- üå∏ ·∫¢nh n·ªÅn d∆∞·ªõi phong b√¨ -->
      <img src="th∆∞_n·ªÅn.png" alt="·∫£nh n·ªÅn l√° th∆∞" class="envelope-bg">

      <!-- üìÑ Th∆∞ -->
      <div class="letter" id="letter">
        <h3>Ng∆∞·ªùi Em Y√™u ‚ù§Ô∏è</h3>
        <p id="letterText"></p>
        <div class="lines">
          <div class="line" style="width:90%"></div>
          <div class="line" style="width:85%"></div>
          <div class="line" style="width:95%"></div>
          <div class="line" style="width:80%"></div>
        </div>
      </div>

      <!-- üíå Note -->
      <div class="note" id="note">
        <div class="tiny">M·ªôt ƒêi·ªÅu Nho Nh·ªè G·ª≠i ƒê·∫øn Anh Y√™u C·ªßa Em üíå</div>
      </div>

      <!-- ‚úâÔ∏è Phong b√¨ -->
      <div class="envelope-wrap idle" id="envelope">
        <img src="th√¢n_2.png" alt="phong b√¨ th√¢n" class="envelope-body">
        <img src="n·∫Øp.png" alt="phong b√¨ n·∫Øp" class="envelope-lid" id="lid">
      </div>

      <!-- üìù H∆∞·ªõng d·∫´n 1 -->
      <div class="guide" id="guide">
        <div class="arrow"></div>
        <div class="guide-text">Anh nh·∫•n v√¥ l√° th∆∞ ƒë·ªÉ m·ªü nh√© üíå</div>
      </div>

      <!-- üìù H∆∞·ªõng d·∫´n 2 -->
      <div class="guide guide-letter" id="guideLetter" style="display: none;">
        <div class="arrow"></div>
        <div class="guide-text">Anh nh·∫•n ti·∫øp ƒëi üíå</div>
      </div>

    </div>
  </div>
</div>

<script>
(function(){
  const clickArea = document.getElementById('clickArea');
  const lid = document.getElementById('lid');
  const note = document.getElementById('note');
  const letter = document.getElementById('letter');
  const lines = Array.from(document.querySelectorAll('.line'));
  const envelope = document.getElementById('envelope');
  const guide = document.getElementById('guide');

  let state = 0;

  const fullText = `G·ª≠i anh y√™u,\nCh√∫c anh c√≥ m·ªôt ng√†y sinh nh·∫≠t th·∫≠t vui v·∫ª\nEm bi·∫øt l√† em c≈©ng c√≥ ƒë√¥i l√∫c b∆∞·ªõng, c√≥ nhi·ªÅu l·∫ßn l√†m anh bu·ªìn. Nh∆∞ng anh kh√¥ng v√¨ t√≠nh c√°ch ·∫•y c·ªßa em m√† b·ªè r∆°i em\nC·∫£m ∆°n anh v√¨ ƒë√£ lu√¥n ·ªü b√™n c·∫°nh em v√† c≈©ng xin l·ªói anh v√¨ nh·ªØng l√∫c l√†m anh bu·ªìn, lo l·∫Øng.\nCh√∫c anh y√™u c·ªßa em lu√¥n m·∫°nh kh·ªèe, vui v·∫ª, th√†nh c√¥ng v√† ƒë·ª´ng qu√™n r·∫±ng c√≥ m·ªôt ng∆∞·ªùi lu√¥n th∆∞∆°ng anh r·∫•t nhi·ªÅu!üíñ\n‚Äî Em b√© c·ªßa anh üíå`;
  document.getElementById('letterText').innerText = fullText;

  function openLid(){ lid.classList.add('open'); envelope.classList.remove('idle'); }
  function closeLid(){ lid.classList.remove('open'); envelope.classList.add('idle'); }

  function animateNote(){
    note.classList.remove('animate');
    void note.offsetWidth;
    note.classList.add('animate');
  }

  function openLetter(){
    letter.classList.add('open');
    lines.forEach((ln, i)=>setTimeout(()=>ln.classList.add('show'), 150+i*100));
  }
  function closeLetter(){
    lines.forEach(ln=>ln.classList.remove('show'));
    letter.classList.remove('open');
  }

  function toState(newState){
    state=newState;
    if(state===0){
      closeLid(); note.classList.remove('animate'); closeLetter();
    } else if(state===1){
      openLid(); animateNote(); closeLetter();
    } else if(state===2){
      openLid(); note.classList.remove('animate'); setTimeout(()=>openLetter(),200);
    }
  }

  clickArea.addEventListener('click', () => {
  // ·∫®n h∆∞·ªõng d·∫´n 1 khi click l·∫ßn ƒë·∫ßu
  if (guide) {
    guide.style.animation = 'fadeOut 0.6s forwards';
    setTimeout(() => guide.remove(), 600);
  }

  // ü©∑ Click 1 ‚Üí hi·ªán h∆∞·ªõng d·∫´n 2 + m·ªü n·∫Øp
  if (state === 0) {
    if (guideLetter) {
      guideLetter.style.display = 'flex';
      guideLetter.style.animation = 'fadeIn 1s ease forwards';
    }
    toState(1);
  }

  // ü©µ Click 2 ‚Üí m·ªü th∆∞ + ·∫©n h∆∞·ªõng d·∫´n 2
  else if (state === 1) {
    if (guideLetter) {
      guideLetter.style.animation = 'fadeOut 0.6s forwards';
      setTimeout(() => guideLetter.remove(), 600);
    }
    toState(2);
  }

  // üåÄ Click 3 ‚Üí reset
  else {
    toState(0);
  }
});


  // ‚ú® Bling
  const container = document.getElementById('blingContainer');
  const numBling = 100;
  for (let i = 0; i < numBling; i++) {
    const star = document.createElement('div');
    star.className = 'bling';
    star.style.left = Math.random() * 100 + '%';
    star.style.top = Math.random() * 100 + '%';
    star.style.animationDelay = (Math.random() * 3) + 's';
    star.style.animationDuration = (1.5 + Math.random() * 1.5) + 's';
    container.appendChild(star);
  }

  // üíñ Floating Hearts
  function createHeart(){
    const heart = document.createElement('div');
    heart.className = 'heart';
    heart.innerText = 'üíï';
    heart.style.left = Math.random() * 100 + 'vw';
    heart.style.fontSize = (16 + Math.random()*18) + 'px';
    heart.style.animationDuration = (5 + Math.random()*4) + 's';
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(), 9000);
  }

  setInterval(createHeart, 600);
})();
</script>
</body>
</html>
